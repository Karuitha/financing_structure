"0","## Regression function - fixed, random and pooling ---- "
"0","modelling_wins <- function(depvar,"
"0","                      effect = c(""individual"", ""twoways"", ""time"", ""nested""),"
"0","                      model = c(""within"", ""random"", ""ht"", ""between"", ""pooling"", ""fd""),"
"0","                      inst.method = c(""bvk"", ""baltagi"", ""am"", ""bms""),"
"0","                      random.method = c(""swar"", ""amemiya"", ""walhus"", ""nerlove""),"
"0","                      digits = 4, index = c(""mfiid"", ""year"")){"
"0","  "
"0","  ## Load libraries"
"0","  library(plm)"
"0","  library(broom)"
"0","  library(pcse)"
"0","  library(car)"
"0","  library(zoo)"
"0","  library(lmtest)"
"0","  library(broom)"
"0","  library(stargazer)"
"0","  "
"0","  ## match arguments"
"0","  effect <- match.arg(effect)"
"0","  model <- match.arg(model)"
"0","  inst.method <- match.arg(inst.method)"
"0","  random.method <- match.arg(random.method)"
"0",""
"0","  "
"0","  ## Run the Model"
"0","  plm(depvar ~ age + currentlegalstatus + "
"0","                      "
"0","                      legal_tradition + "
"0","                      "
"0","                      assets + kkm + pcrdbgdp + "
"0","                      "
"0","                      log(stmktcap) + log(profit_margin) + "
"0","                      "
"0","                      log(donations_assets_ratio) + "
"0","                      "
"0","                      gdp_growth_annual + factor(year), "
"0","                      "
"0","                      data = data_wins,"
"0","                    "
"0","                    effect = effect,"
"0","                    "
"0","                    model = model, "
"0","                    "
"0","                    inst.method = inst.method, "
"0","                    "
"0","                    index = index, "
"0","                    "
"0","                    digits = digits)"
"0","  "
"0","  ## Output results"
"0","       "
"0","       ## Correct standard errors for heteroscedasticity "
"0","       ## And cross-sectional dependence"
"0","       "
"0","       #coeftest(unadjusted, vcov. = function(x) {"
"0","         #vcovBK(x, method = ""arellano"", type=""HC1"", cluster = ""group"")"
"0","       #})"
"0","}"
"0",""
